#!/usr/bin/env bash

has() {
  type "$1" >/dev/null 2>&1
}

mktemp() {
  command mktemp 2>/dev/null || command mktemp -t tmp
}

_TEMP_FILE=$(mktemp)
_TEMP_FILE2=$(mktemp)

trap "rm -f ${_TEMP_FILE} ${_TEMP_FILE2}; exit 1" 1 2 3 15

if has "cowsay"; then
cat<<'HERE' > $_TEMP_FILE
$the_cow = <<EOC;
  5555555555555 3 555555 33 5 333   3333333  555 33333 5555555555555555555   33 5 33333 555 3       33   333 5555555  55555  555 3    33333    3
   5555555555 5 3 555555 33 5 33333 333333333     333333  5555555555555555 333 3   33333    335      33  333 5555555  55555  555 33   33 33    3
      555555  5 3 55555 33   333333 33333333333   33333333   5555555  55555     33 333333 55 3 55     3  3333 555555  55555      33   33  33  3
         555    3 55   3333  333     3333   3333    333333333   55555  555555   33  3 3333 5 3 5555   33333333 55555  5555553     33  33  33 3
           5  5 3     5 333  333   3333333  333333   33333333333  5555   5555   3 3    3333  3 55555   333  33 55555  555   333   33 33    33
                33 5555 333  333   3333333   33333333 333333333333  555   55 5     3    333  3 555555  33 5 333 5555 5      333   33333    33
                33      3333 333  5  33333  5    33333333333333333333  5   5       3     3333 55555   3 3   333             3333  33333    3
                333     3333 333  55  33333 55       3333333333  333333     5   55    55 3333333           3333             3333  33333    3
                3333    33333333 5555  33333 5555       33333333   33333  3 5   55    55 3         333         3   3        33333333333   3
                33333   333  3333 55555 33333 555555      333333     3333333  3 555 3  3    3  555555  5  3    3333          333333333
3            3  333333  333  3333 5555555 3333 55555555      3333     3333333  5        3  5555555555 555555 33  3            33333333   3
33           3   333333  3335 333 555555555   33 55555555      33      3333333  55 3 3 555555555555555555555 33 33          53 3333333  3
333           3  3333 33 333  3   3   3333333       55555555    3      333333 5555   5555555555555555555555 33333          553 33  3333 3
 333          33 3333 5 33                       3  5555555555 5  5     3333 5555  55555555555555555555555 33 33           553  33333333
  333          3  333   3       33   555555555   333  555555555555555   333 55555555555555555555555555555 3  5 3          555   3   33
   3333         3 3333         555555555555555555555   55555555555555   33 5555555555555555555555555555    555             5  333    3
3   3333        33 3      3 5   55555555555555555555555555555555555555  5555555555555555555555555555555 555555           3 5 3 333   3
33   33333       3 3      555555555555555555555555555555555555555555555555555555555555555555555555555555555555            5 33333333
333    33333      33333355555555555555555555555555555555555555555555555555555555555555555555555555555555555555           5
3333     33333     33333 5555555555555555555555555555555555555555555555555555555555555555555555555555555555555           3
33333     333333    33333 55555555555555555555555555555555555555555555 555555555555555555555555555555555555555         3
333333       33333   333333 555555555555555555555555555555555555555555 555555555555555555555555555555555555555         3
33333333       33333333333 3  55555555555555555555555555555555555555555555555555555555555555555555555555555555
3333333          3333333333    5555555555555555555555555555555555555555555555555555555555555555555555555555555             3333333
333333555           33333333 5555555555555555555555555555555555555555555555555555555555  55555555555555555555 3            555555 3
3333335                3333333 555555555555555555555555555555555555555555555555555     5 5555555555555555555       555555555555555 3
333333     5             33  33  5555555555555555555555555555555555555555   5  555555555  55555555555555555   555555555555555555555 3
3333333                      5      55555555555555555555                555555555555555   555555555555555   5555555555555555555555553
33333333 5555    3            55555  555555555555555555  5555555555555555555555555555555  55555555555555   555555555    555555555555
333        55                  555555555555555555555555  5555555555555555555555555555555 55555555555555  55555555       555555555555
             5                  55555555555555555555555   5555555555555555555555555555  5555555555555  5555555           55555555555
                55     3         55555555555555555555555  55555555555555555555555555   555555555555   555555             55555555555 3
                     55 33          555555555555555555555  5555555555555555555555   5555555555555   555555    33      333 5555  5555 3
5                       3333      33   55555555555555555555    555555555555555   55555555555555    5555             33   3 555  55555
                        33333      3     55555555555555555555555           55555555555555555     5555               3     3 555  5555 3
                        333333     3         55555555555555555555555555555555555555555555                          33       3 55     3
                         3333333    3       33    5555555555555555555555555555555555555       555555555555555555555  3        33   33      33
                         33333333   33       3333333      5555555555555555555555555   3   5555555555555555555555555555 3                   3
                         333333333   3       3333333333333333          55555555   333   5555555555555555555555555555555 3                 3
                         333333333   3        3 333333   33333333333333333    33333     555555                     55555                    3
EOC
HERE
else
cat<<'HERE' > $_TEMP_FILE
  5555555555555 3 555555 33 5 333   3333333  555 33333 5555555555555555555   33 5 33333 555 3       33   333 5555555  55555  555 3    33333    3
   5555555555 5 3 555555 33 5 33333 333333333     333333  5555555555555555 333 3   33333    335      33  333 5555555  55555  555 33   33 33    3
      555555  5 3 55555 33   333333 33333333333   33333333   5555555  55555     33 333333 55 3 55     3  3333 555555  55555      33   33  33  3
         555    3 55   3333  333     3333   3333    333333333   55555  555555   33  3 3333 5 3 5555   33333333 55555  5555553     33  33  33 3
           5  5 3     5 333  333   3333333  333333   33333333333  5555   5555   3 3    3333  3 55555   333  33 55555  555   333   33 33    33
                33 5555 333  333   3333333   33333333 333333333333  555   55 5     3    333  3 555555  33 5 333 5555 5      333   33333    33
                33      3333 333  5  33333  5    33333333333333333333  5   5       3     3333 55555   3 3   333             3333  33333    3
                333     3333 333  55  33333 55       3333333333  333333     5   55    55 3333333           3333             3333  33333    3
                3333    33333333 5555  33333 5555       33333333   33333  3 5   55    55 3         333         3   3        33333333333   3
                33333   333  3333 55555 33333 555555      333333     3333333  3 555 3  3    3  555555  5  3    3333          333333333
3            3  333333  333  3333 5555555 3333 55555555      3333     3333333  5        3  5555555555 555555 33  3            33333333   3
33           3   333333  3335 333 555555555   33 55555555      33      3333333  55 3 3 555555555555555555555 33 33          53 3333333  3
333           3  3333 33 333  3   3   3333333       55555555    3      333333 5555   5555555555555555555555 33333          553 33  3333 3
 333          33 3333 5 33                       3  5555555555 5  5     3333 5555  55555555555555555555555 33 33           553  33333333
  333          3  333   3       33   555555555   333  555555555555555   333 55555555555555555555555555555 3  5 3          555   3   33
   3333         3 3333         555555555555555555555   55555555555555   33 5555555555555555555555555555    555             5  333    3
3   3333        33 3      3 5   55555555555555555555555555555555555555  5555555555555555555555555555555 555555           3 5 3 333   3
33   33333       3 3      555555555555555555555555555555555555555555555555555555555555555555555555555555555555            5 33333333
333    33333      33333355555555555555555555555555555555555555555555555555555555555555555555555555555555555555           5
3333     33333     33333 5555555555555555555555555555555555555555555555555555555555555555555555555555555555555           3
33333     333333    33333 55555555555555555555555555555555555555555555 555555555555555555555555555555555555555         3
333333       33333   333333 555555555555555555555555555555555555555555 555555555555555555555555555555555555555         3
33333333       33333333333 3  55555555555555555555555555555555555555555555555555555555555555555555555555555555
3333333          3333333333    5555555555555555555555555555555555555555555555555555555555555555555555555555555             3333333
333333555           33333333 5555555555555555555555555555555555555555555555555555555555  55555555555555555555 3            555555 3
3333335                3333333 555555555555555555555555555555555555555555555555555     5 5555555555555555555       555555555555555 3
333333     5             33  33  5555555555555555555555555555555555555555   5  555555555  55555555555555555   555555555555555555555 3
3333333                      5      55555555555555555555                555555555555555   555555555555555   5555555555555555555555553
33333333 5555    3            55555  555555555555555555  5555555555555555555555555555555  55555555555555   555555555    555555555555
333        55                  555555555555555555555555  5555555555555555555555555555555 55555555555555  55555555       555555555555
             5                  55555555555555555555555   5555555555555555555555555555  5555555555555  5555555           55555555555
                55     3         55555555555555555555555  55555555555555555555555555   555555555555   555555             55555555555 3
                     55 33          555555555555555555555  5555555555555555555555   5555555555555   555555    33      333 5555  5555 3
5                       3333      33   55555555555555555555    555555555555555   55555555555555    5555             33   3 555  55555
                        33333      3     55555555555555555555555           55555555555555555     5555               3     3 555  5555 3
                        333333     3         55555555555555555555555555555555555555555555                          33       3 55     3
                         3333333    3       33    5555555555555555555555555555555555555       555555555555555555555  3        33   33      33
                         33333333   33       3333333      5555555555555555555555555   3   5555555555555555555555555555 3                   3
                         333333333   3       3333333333333333          55555555   333   5555555555555555555555555555555 3                 3
                         333333333   3        3 333333   33333333333333333    33333     555555                     55555                    3
HERE
fi

wget -q "https://raw.githubusercontent.com/tomorinao/tomorinao/master/TomoriNao.txt" -O $_TEMP_FILE2

_NR=$(awk 'END{print NR}' $_TEMP_FILE2)

if has "cowsay"; then
  cowsay -f $_TEMP_FILE $(head -$((${RANDOM}%${_NR}+1)) $_TEMP_FILE2|tail -1)
else
  _SERIFU=$(head -$((${RANDOM}%${_NR}+1)) $_TEMP_FILE2|tail -1)
  _BYTES=$(($(echo $_SERIFU|wc -c)/2))
  seq $_BYTES|xargs|tr -d " "|sed 's/./-/g'
  echo $_SERIFU
  seq $_BYTES|xargs|tr -d " "|sed 's/./-/g'
  echo
  cat $_TEMP_FILE
fi

rm -f ${_TEMP_FILE} ${_TEMP_FILE2}